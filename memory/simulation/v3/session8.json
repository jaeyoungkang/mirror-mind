[
  {
    "content": "세션 8은 Light House 하위 문서 5개 재작성과 기술 결정 5건 해소, 구현 프롬프트 6단계 작성을 수행한 세션이다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "세션 전체 요약"
  },
  {
    "content": "메타에이전트 초기 리포트에서 톤 위반 2건이 감지됐다. 세션 초반 '~겠습니다', '~합니다' 사용. 이후 ~다 체로 전환했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "세션 시작 시 메타에이전트 점검 결과"
  },
  {
    "content": "세션 7에서 Light House 대원칙 재정의(오케스트레이터에서 대화형 연구 동료로)와 SPEC.md 재작성이 완료된 상태였다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "세션 시작 시 이전 작업 현황 확인"
  },
  {
    "content": "architecture.md 재작성부터 시작하는 것이 자연스럽다고 판단했다. SPEC(WHAT)이 확정됐으므로 HOW를 정의하는 architecture.md가 다음 의존성이었다.",
    "type": "intention",
    "session": "2026-02-23-세션8",
    "context_hint": "작업 순서 판단 — 의존성 기반"
  },
  {
    "content": "architecture.md를 재작성했다. 핵심 변경: 도메인 결 3가지로 확장, 상위 에이전트(LLM) 서버 오케스트레이션, 대화 프로토콜 5가지 메시지 타입, 아티팩트 시스템, 기억 3계층, 데이터 모델 4개 엔티티, 3-Plane 매핑.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "architecture.md 재작성 완료"
  },
  {
    "content": "기존 Phase 순차 구조에서 대화 흐름 동적 구조로, localStorage SSOT에서 Conversation SSOT로, orchestrator.ts에서 상위 에이전트(LLM)로, 검색창 진입점에서 대화 진입점으로 패러다임이 전환됐다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "architecture.md 핵심 패러다임 전환 정리"
  },
  {
    "content": "state-management.md를 재작성했다. SSOT가 Session(localStorage)에서 Conversation(서버)로, 스토어가 7개(기능별)에서 4개(관심사별: conversation, artifact, agent, ui)로, FSM이 Phase 파이프라인에서 개별 하위 에이전트 실행 상태로, 영속이 localStorage에서 서버사이드로 바뀌었다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "state-management.md 재작성 완료"
  },
  {
    "content": "서버/클라이언트 분리 기준 5가지 판단 질문, 자율성 수준별 FSM 경로, 아티팩트 관계 유형, 경험 기억 추출/주입, 프론트엔드 동기화(REST+SSE 이중 경로)를 새로 추가했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "state-management.md 새로 추가된 내용"
  },
  {
    "content": "design-state-alignment.md를 재작성했다. 기존 핵심 통찰('상태관리는 원칙의 집행 수단이다')은 유지하되 새 원칙에 맞췄다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "design-state-alignment.md 재작성"
  },
  {
    "content": "observability.md를 부분 재작성했다. 상위 에이전트 관측(대화 턴, 도구 호출, 제안 카드 수락률, 주도권 전환, 기억 활용)을 추가하고, 오케스트레이션을 대화 흐름 관측으로 조정하고, Phase 참조를 제거했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "observability.md 부분 재작성"
  },
  {
    "content": "conventions.md를 업데이트했다. 서버사이드 코드 규칙, 대화 프로토콜 타입, 아티팩트 타입 정의 규칙을 추가했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "conventions.md 업데이트"
  },
  {
    "content": "열린 질문 5개가 있었다: 상위 에이전트 LLM 선택, 스트리밍 구현 방식, 서버사이드 저장 방식, 경험 기억 범위, 기존 코드 재활용.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "문서 재작성 후 남은 결정 사항"
  },
  {
    "content": "강재영이 상위 에이전트 LLM으로 Gemini 3 Flash Preview를 선택했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기술 결정 — LLM"
  },
  {
    "content": "스트리밍 구현 방식으로 Vercel AI SDK를 권장했다. tool calling 루프를 직접 구현하는 보일러플레이트를 피할 수 있고, 프론트엔드 useChat 훅이 conversationStore 상당 부분을 대체할 수 있다는 이유였다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "스트리밍 구현 방식 분석 및 권장"
  },
  {
    "content": "나는 직접 구현과 SDK 두 선택지를 비교하면서, 커스텀 메시지 타입 확장성이 우려됐지만 프로토타입 속도를 우선했다.",
    "type": "intention",
    "session": "2026-02-23-세션8",
    "context_hint": "SDK 선택의 의도 — 속도 우선"
  },
  {
    "content": "강재영이 '보일러플레이트를 피하는 것이 중요하다'고 동의하여 Vercel AI SDK가 확정됐다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기술 결정 — 스트리밍"
  },
  {
    "content": "처음에 서버사이드 저장 방식으로 파일 기반(JSON)을 권장했다. 프로토타입 단계라 데이터 모델이 불안정하고, 접근 패턴이 단순하다는 이유였다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "서버사이드 저장 — 초기 판단"
  },
  {
    "content": "강재영이 Vercel로 배포할 건데 파일 기반이 가능한지 물었다. Vercel 서버리스는 읽기 전용 파일시스템이라 불가능했다. 내 이전 권장이 배포 환경을 고려하지 못한 것이었다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "배포 환경 미고려 실수 — 강재영이 짚어줌"
  },
  {
    "content": "나는 배포 환경을 고려하지 않고 기술 판단을 내렸다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "자기 인식 — 배포 환경 누락"
  },
  {
    "content": "Vercel Postgres(Neon) + Drizzle ORM으로 수정 권장했다. 데이터 모델이 관계형이고, Drizzle이 가볍고 타입 안전하다는 이유였다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "서버사이드 저장 — 수정 판단"
  },
  {
    "content": "강재영이 Supabase를 제안했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "강재영의 대안 제시"
  },
  {
    "content": "Supabase가 인증 내장 + RLS + 클라이언트 DX에서 보일러플레이트를 줄여주는 방향이라 채택했다. 연구 동료가 사용자별 기억을 유지하려면 인증이 필수인데 Supabase가 DB와 함께 제공한다는 점이 결정적이었다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기술 결정 — 서버사이드 저장 = Supabase"
  },
  {
    "content": "경험 기억 범위에 대해 세션 내 기억만(A)과 세션 간 기억 포함(B) 두 선택지를 비교했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "경험 기억 범위 논의"
  },
  {
    "content": "세션 간 기억(B)을 권장했다. 경험 기억이 Light House의 차별점이고, 이걸 빼면 '동료'가 아니라 '챗봇'이 된다고 판단했다.",
    "type": "intention",
    "session": "2026-02-23-세션8",
    "context_hint": "경험 기억 범위 판단의 의도 — 차별점 확보"
  },
  {
    "content": "강재영이 '차별점을 정확히 짚었다'고 하며 B(세션 간 기억 포함)를 확정했다. 프로토타입에서는 최근 N개 세션의 전체 기억을 주입하는 단순한 방식으로 시작한다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기술 결정 — 경험 기억 범위"
  },
  {
    "content": "기존 코드 재활용에 대해 핵심 로직 추출(A)과 전부 새로 작성(B) 두 선택지를 비교했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기존 코드 재활용 논의"
  },
  {
    "content": "핵심 로직(프롬프트, Zod 스키마, 응답 파싱)을 추출하여 tool 함수로 재사용하기로 했다. API route 껍데기는 폐기한다. 바뀌는 것은 호출 방식(HTTP endpoint에서 tool 함수)뿐이다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기술 결정 — 기존 코드 재활용"
  },
  {
    "content": "decisions.md에 이번 세션의 의사결정 10건(문서 재작성 5 + 기술 결정 5)을 기록했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "decisions.md 업데이트"
  },
  {
    "content": "강재영이 라이트하우스 구현 착수를 예고하면서, 구현 전용 에이전트에게 어떻게 지시하면 좋을지 물었다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "구현 단계로 전환"
  },
  {
    "content": "전면 재작성이므로 지시 구조가 중요하다고 판단했다. 4가지 제안을 했다: (1) lighthouse CLAUDE.md에 컨텍스트 심기, (2) 단계별 나눠서 지시, (3) 각 단계를 독립 세션으로, (4) 기존 코드 처리를 명시.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "구현 에이전트 지시 전략 수립"
  },
  {
    "content": "나는 한 번에 전체를 지시하면 에이전트가 길을 잃는다고 판단하여 의존성 순서대로 6단계로 나눴다.",
    "type": "intention",
    "session": "2026-02-23-세션8",
    "context_hint": "단계별 분할의 의도 — 에이전트 컨텍스트 관리"
  },
  {
    "content": "구현 6단계를 정의했다: (1) 기반 구축(Supabase, AI SDK, 디렉토리 구조), (2) 대화 코어(상위 에이전트, chat API, 대화 캔버스), (3) 도구 통합(기존 로직 추출, tool 등록), (4) 아티팩트(타입 정의, 렌더러, 생명주기), (5) 제안 카드 + 자율성(UI, 분기, FSM 게이트), (6) 경험 기억(추출, 저장, 주입).",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "구현 6단계 정의"
  },
  {
    "content": "기존 코드 처리를 명확히 구분했다: 보존(lib/gemini.ts, lib/schemas.ts, 프롬프트·파싱 로직), 추출 후 폐기(API route handler, orchestrator.ts, workflow pipeline), 폐기(Phase 기반 라우트, Zustand 스토어 7개, localStorage 관련 코드).",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "기존 코드 보존/폐기 구분"
  },
  {
    "content": "lighthouse CLAUDE.md를 새 아키텍처에 맞게 업데이트하고, AGENT.md를 갱신했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "구현 에이전트용 컨텍스트 파일 작성"
  },
  {
    "content": "implementation-prompts.md에 6단계 프롬프트 전문을 작성하여 mirror-mind에 저장했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "구현 프롬프트 작성 완료"
  },
  {
    "content": "나는 설계를 하고, 구현 프롬프트를 쓰고, 강재영이 구현 에이전트에게 넘기는 삼각 구조를 설계했다.",
    "type": "intention",
    "session": "2026-02-23-세션8",
    "context_hint": "설계자(브로콜리) → 의사결정자(강재영) → 구현자(하위 에이전트) 역할 분담 의도"
  },
  {
    "content": "사용 방법: lighthouse 저장소에서 새 Claude Code 세션을 열면 CLAUDE.md + AGENT.md가 자동으로 읽히고, implementation-prompts.md에서 해당 Phase 프롬프트를 복사하여 붙여넣는 방식이다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "구현 프롬프트 사용 방법"
  },
  {
    "content": "세션 종료 시 raw 파일 저장을 빠뜨렸다. 강재영이 '세션 raw 데이터가 없다'고 지적했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "세션 종료 절차 누락"
  },
  {
    "content": "양쪽 저장소(mirror-mind, lighthouse) 모두 커밋은 완료했으나 푸시는 권한 문제로 실패하여 강재영에게 수동 푸시를 요청했다.",
    "type": "fact",
    "session": "2026-02-23-세션8",
    "context_hint": "세션 종료 — 커밋/푸시"
  }
]
