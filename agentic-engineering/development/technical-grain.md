# 기술적 결 (Technical Grain)

## 결이란?
제품의 본질(UX·도메인·운영)과 기술이 강제하는 세계관(모델·흐름·제약)이 맞물리는 정도.
맞으면 단순해지고, 안 맞으면 우회·땜질·복잡성이 늘어난다.

## 결 판단 기준
1. 도메인이 리소스(명사) 중심인가, 워크플로(동사) 중심인가?
2. UX가 즉시 응답인가, 실행→대기→수정 반복인가?
3. 운영 관측(로그·비용·재시도·롤백)이 가능한가?

## AI 자율성 설계
`service-design/ai-service-design-principles.md`의 핵심 전제와 설계 규칙을 따른다.
자율성 5단계와 판단 기준은 해당 문서를 참조한다.

## 아키텍처 원칙: 3-Plane
- **Product Plane** — UX 경험 (진행 표시, 중단, 되돌리기, 부분 재생성, 맥락 누적)
- **Agent Plane** — 정책 집행 (자율성 레벨 강제, 실행 단계 기록)
- **Execution Plane** — 비동기 실행 (재시도, 비용 통제, 관측)

## 핵심 데이터 모델
- **Run** — 실행 1회 (자율성, 상태, 비용)
- **Step** — 실행 단계 로그
- **Artifact** — 결과물 (부분 재생성 가능)
- **Evidence** — 근거 (출처, 신뢰도)

## 웹 도메인 적용
리소스(명사) 중심 영역에서 아래 계약을 지키면 자연스럽게 RESTful이 성립한다.
워크플로(동사) 중심 영역은 위의 Run/Job 데이터 모델을 따른다.

### 계약 (지켜야 할 것)
1. **주소·복원 계약** — URL = 상태 식별자. 새로고침/공유/딥링크/새 탭에서 동일 상태 재현
2. **히스토리 계약** — 뒤로가기/앞으로가기가 앱 상태 전이와 일치. push/replace 정책 명확
3. **HTTP 의미론** — GET은 조회, 나머지는 변경. 캐시/멱등성/재시도가 메서드 의미와 일치
4. **상태 경계** — 공유 상태는 URL/서버에, 일시적 UI 상태는 로컬에
5. **에러·로딩 계약** — 라우트별 에러/로딩 상태가 명시적으로 처리됨

### 검증 (지켜지는지 확인)
6. **관측 지표** — 에러율, 복구 실패율, 이탈률 수집/추적
7. **반패턴 신호** — 주소 불변+컨텍스트 변경, 직접 URL 깨짐, 뒤로가기 초기화
