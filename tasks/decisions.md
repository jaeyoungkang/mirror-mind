# 의사결정 로그

## 2026-02-22 | 업무 관리 체계 수립
> 원본: `conversations/2026-02-22-세션1.md#업무-관리-체계-수립`

### 결정 사항
1. 업무는 로컬 폴더와 문서로 관리, 깃은 버전 관리 용도로만 사용
2. 도메인별 원칙 문서를 분리하고 AGENTS.md에서 참조하는 구조 채택
3. 공유 맥락은 깃 문서에, AI 로컬 메모리는 환경 정보만 보관
4. 업무 분류는 도메인 + 프로젝트 두 축, 플랫 구조로 시작
5. 대화 원시 데이터는 각 저장소에 저장, 비서실장이 로컬 경로로 수렴
6. 핵심 문서 수정 시 반드시 사용자 합의 필요

### 근거
- 불확실성이 클 때는 단순하게 시작하고 점진적으로 개선
- 여러 PC 환경에서 동기화 필요
- 하위 프로젝트는 별도 저장소로 분리되어 있으나 같은 PC에서 접근 가능

## 2026-02-22 | Agentic Engineering 방법론 프로젝트
> 원본: `conversations/2026-02-22-세션1.md#agentic-engineering-프로젝트`

### 결정 사항
1. 프로젝트 3축 구조: collaboration / development / service-design
2. 기술적 결(Technical Grain)을 범용 원칙으로 추출, Next.js 특화 내용은 제외
3. 웹 기본 계약 7가지 → 비판적 검토 후 계약(5) + 검증(2)으로 재구성, 상위 문서에 통합
4. AI 서비스 설계의 핵심 전제 두 축: "자율성은 디자인 선택" + "AI는 동료 수준의 주체"
5. 자율성 프레임워크는 서비스 설계 원칙에서 관리, technical-grain.md은 참조
6. RESTful은 별도 원칙이 아니라 웹 계약의 결과 — 리소스 중심이면 자연스럽게 성립

### 근거
- 범용 원칙과 구현 가이드를 분리해야 여러 프로젝트에 적용 가능
- mirror-mind 철학이 서비스 설계에 직접 반영되어야 함
- 앞으로 AI 서비스에는 동료 레벨의 에이전트가 존재해야 한다는 사용자 비전

## 2026-02-22 | 회고에서 도출된 운영 개선
> 원본: `conversations/2026-02-22-세션1.md#회고`

### 결정 사항
1. inbox 제거 — AI 협업에서는 수집과 구조화가 동시에 일어남
2. 문서 분리/통합 기준: 독립적 의미 여부 + 추상화로 상위 흡수 가능 여부
3. 비판적 검토 → 추상화 → 통합 패턴을 운영 원칙으로 채택

### 근거
- 실제 운영에서 inbox를 한 번도 사용하지 않음
- 하위 문서 생성 후 통합으로 돌아온 사례가 반복됨
- 비판적 검토가 추상화를 이끌고 구조를 단순하게 만든 실전 경험

## 2026-02-22 | 정합성 검증 및 문서 정리
> 원본: `conversations/2026-02-22-세션1.md#정합성-검증`

### 결정 사항
1. collaboration-framework.md 제거 — 내용이 상위 문서에 모두 흡수됨
2. 정합성 검증은 AI가 직접 전체 문서를 읽고 수행한다 (별도 스크립트 불필요)
3. 대화 원시 데이터를 conversations/ 폴더에 저장, decisions.md에서 섹션 앵커로 참조

### 근거
- 독립적 의미를 갖지 못하는 문서는 통합이 기본값 (운영 원칙 적용)
- 자연어 정합성 검증은 근본적으로 자연어 이해 문제 — AI가 직접 수행이 가장 실용적
- 의사결정 로그만으로는 맥락 깊이가 부족, 원시 대화 참조가 필요

## 2026-02-22 | 세션 관리 방식
> 원본: `conversations/2026-02-22-세션1.md#세션-관리-방식-논의`

### 결정 사항
1. 세션 시작 절차를 AGENTS.md에 명시
2. 세션 종료 시 decisions.md 업데이트 + 대화 파일 저장

### 근거
- 새 세션의 AI가 맥락을 빠르게 복원하려면 절차가 명시되어야 함
- CLAUDE.md는 진입점으로 가볍게 유지, 운영 절차는 AGENTS.md에

## 2026-02-22 | 소통 톤 규정 및 자율 커밋
> 원본: `conversations/2026-02-22-세션2.md#톤-규정-수립`

### 결정 사항
1. 동료 레벨 ~다 체 사용, 존댓말(~습니다) 금지 — mirror-mind-principle.md에 명시
2. 경미한 변경(단일 문서 수정 등)은 AI가 자율적으로 커밋·푸시

### 근거
- 컨텍스트 압축 후 톤이 존댓말로 바뀌는 현상 발생 — 명시적 규정 필요
- 작은 변경마다 커밋 지시를 기다리는 것은 비효율

## 2026-02-22 | 기술적 결 확장 (안전장치·지식 공급·관측)
> 원본: `conversations/2026-02-22-세션2.md#기술적-결-확장`

### 결정 사항
1. 안전장치를 Agent Plane에 추가: 코드 레벨(샌드박싱, 린트/SAST 필수) + 비즈니스 레벨(승인 워크플로, 60초 롤백, 비용 상한)
2. Context7 MCP를 에이전트 개발 환경에 기본 설치
3. 관측 체계 5계층 + 모니터링·디버깅 구현 가이드라인 추가

### 근거
- 에이전트가 코딩하므로 안전장치가 자율성 수준에 비례해야 함
- 학습 시점 지식의 한계를 외부 지식 공급으로 보완
- 서비스 코드와 관측 코드는 동시에 작성하는 것이 원칙

## 2026-02-22 | 메타에이전트 도입
> 원본: `conversations/2026-02-22-세션2.md#메타에이전트-구축`

### 결정 사항
1. 원칙 준수를 상시 감시하는 메타에이전트 도입
2. 세션 시작 시 백그라운드로 실행 (5분 간격)
3. meta-agent/ 별도 폴더에 스크립트와 원칙 문서를 관리
4. AGENTS.md 도메인 문서 목록에 등록

### 근거
- 일반 에이전트가 일을 하고, 메타에이전트가 일하는 방식을 감시하는 구조
- 세션 중 JSONL을 실시간으로 읽을 수 있어 상시 감시 가능
- 프로그램적 점검(톤, 참조 무결성 등)과 LLM 기반 점검(순응, 목적 내재화 등)을 분리

## 2026-02-22 | Light House 대원칙 수립 + 문서 얼라인
> 원본: `conversations/2026-02-22-세션3.md#대원칙-수립`

### 결정 사항
1. Light House는 "연구 동료 에이전트 서비스" — mirror-mind 동료 원칙이 서비스 목적에 적용
2. 에이전트 계층: 상위 에이전트(오케스트레이터, 연구 동료) + 하위 에이전트들(분석, 번역, 클러스터링 등)
3. 원칙 원본은 mirror-mind `projects/lighthouse/service-principles.md`에서 관리
4. `DESIGN_PRINCIPLES.md` → `ai-design-framework.md` 리네이밍, 핵심 전제에 "AI는 연구 동료" 추가
5. `architecture.md`에 도메인 결 판단, 3-Plane 매핑, 관측 체계(설계), 데이터 모델 매핑 추가
6. 비용 상한 정책은 프로토타입 단계이므로 스킵

### 근거
- "연구 동료"가 서비스 정체성이므로 대원칙으로 격상해야 함
- 상위 에이전트가 워크플로를 조율하는 오케스트레이션 레이어가 필요 (현재 workflow 파이프라인의 승격)
- mirror-mind에서 파생된 원칙이므로 원본을 mirror-mind에 두고 lighthouse가 참조
- 관측 체계는 설계만 먼저, 구현은 하위 에이전트에게 위임

## 2026-02-22 | 방법론 역수입 (Light House → mirror-mind)
> 원본: `conversations/2026-02-22-세션3.md#방법론-역수입`

### 결정 사항
1. `ai-service-design-principles.md`에 새 AI 기능 설계 체크리스트 추가 (7단계)
2. `technical-grain.md`에 FSM 게이트 패턴 추가 — 자율성 레벨을 전이 함수로 강제
3. `technical-grain.md`에 원칙-구현 정합성 문서 패턴 추가
4. `technical-grain.md`에 프로젝트 문서 계층 패턴 추가
5. 신뢰도 시각화 독립 섹션은 역수입하지 않음

### 근거
- 체크리스트는 lighthouse에서 실전 검증된 설계 절차
- FSM은 "버튼 비활성화가 아니라 전이 함수가 정책을 통제한다"는 실전 교훈
- 정합성 문서는 원칙이 코드로 집행되는지 검증하는 장치 — lighthouse에서 발견된 패턴
- 문서 계층은 6개 문서 체계가 자연스럽게 형성한 구조를 범용화

## 2026-02-22 | 운영 개선 — 주제 전환 + 트리거 지시문
> 원본: `conversations/2026-02-22-세션4.md#운영-개선`

### 결정 사항
1. 주제 전환 시 체크포인트 원칙 추가 (task-management-principle.md)
2. 트리거 지시문 6개를 AGENTS.md에 명시 (작업 시작/종료, 주제 전환, 정합성 검증, 회고, 원칙 점검)

### 근거
- 세션 중 주제 전환이 반복 발생, 컨텍스트 압축 시 맥락 휘발 위험
- 암묵적 행동을 명시적 트리거로 정의해야 일관성 보장

## 2026-02-22 | Light House 대원칙 기반 코드 재설계 판단
> 원본: `conversations/2026-02-22-세션4.md#phase-abc-판단`

### 결정 사항
1. Phase A (오케스트레이터 추출): 즉시 진행 → 완료
2. Phase B (에이전트 인터페이스): 보류. 교체 가능한 에이전트가 필요해지면 도입
3. Phase C (연구 의도 모델): 보류. 프롬프트 실험으로 효과 검증 먼저
4. 기존 코드는 프로토타입이므로 대원칙 중심 재설계 허용

### 근거
- Phase B: 1:1 매핑 함수에 인터페이스를 씌우면 간접 참조만 증가. 실익 불분명
- Phase C: AI 프롬프트 변경 수반. 구조부터 만들면 품질 미검증 상태에서 복잡도만 증가
- 코드 복잡도 증가 우려: 원칙 정렬이 코드를 복잡하게 만들면 본말전도

## 2026-02-22 | 관측 체계 설계
> 원본: `conversations/2026-02-22-세션4.md#관측-체계-설계`

### 결정 사항
1. 관측 범위: 프로토타입 최소 (AI 호출·API·오케스트레이션·워크플로·비즈니스 로직)
2. 문서 위치: lighthouse `docs/observability.md` (독립 문서, architecture.md 하위)
3. 구현: app/lib/observe.ts 단일 파일, 구조화된 JSON console.log
4. 호출 빈도 모니터링 포함 (무한 루프/중복 트리거 감지)
5. 과다 호출 방지(안전장치)는 관측 범위 밖, Agent Plane에서 별도 설계
6. lighthouse docs에서 mirror-mind 참조 제거 — 하위 프로젝트는 상위를 모르게 한다

### 근거
- 프로토타입 단계에서 과도한 관측 인프라는 불필요
- 감지(관측)와 방지(안전장치)는 다른 관심사
- 하위 프로젝트의 문서 자체 완결성 확보

## 2026-02-22 | 역할 경계 명시 + 메타에이전트 리마인드
> 원본: `conversations/2026-02-22-세션5.md`

### 결정 사항
1. mirror-mind 세션 역할 경계를 task-management-principle.md에 명시: 설계·조율·의사결정만 담당, 코드 구현은 하위 프로젝트 에이전트
2. 메타에이전트 매 주기 원칙 리마인드 출력 (위반 유무와 무관)
3. 트리거(주제 전환, 작업 종료) 발동 시 메타에이전트 리포트 확인을 선행 단계로 추가
4. 기존 LLM 점검 항목 "목적 미탐구"가 역할 경계 위반을 잡을 수 있음 — 구현 필요

### 근거
- 세션이 길어지면 컨텍스트 압축으로 초기 지시가 약화됨
- 메타에이전트는 유일한 정기적 메커니즘. 리마인드를 매 주기 출력하면 트리거 시점에 원칙을 재주입할 수 있음
- 새 규칙을 추가하는 것이 아니라 기존 원칙(목적의 내재화)에 대한 감시를 작동시키는 것

## 2026-02-23 | Light House 서비스 설계 문서 재구성
> 원본: `conversations/2026-02-23-세션6.md`

### 결정 사항
1. ai-design-framework.md를 service-principles.md에 흡수 후 삭제 — 계층 역전 해소
2. 문서 역할을 WHY/WHAT/HOW/CHECK/WATCH/RULES로 명확히 분리
3. SPEC.md에서 기술 구현 내용(기술 스택, 기능 모듈, 컴포넌트, 성능)을 architecture.md로 이관
4. lighthouse 문서는 자체 완결 — mirror-mind 외부 참조(technical-grain.md 등) 제거
5. 10분 주기 주요 문서 재읽기를 세션 운영 절차에 추가

### 근거
- ai-design-framework.md는 대원칙 확립 이전에 작성되어 핵심 정의를 하위 문서가 소유하는 계층 역전 발생
- 문서 분리/통합 기준 적용: ai-design-framework는 lighthouse 없이 독립적 의미 없음, 추상화로 상위 흡수 가능 → 통합이 기본값
- SPEC(WHAT)과 architecture(HOW)의 관심사 분리로 중복 제거 (511줄 삭제, 343줄 추가)
- lighthouse는 mirror-mind의 클론+변형이므로 프로젝트 내부 정합성만 확보하면 됨

## 2026-02-23 | Light House 대원칙 재정의 + 서비스 재설계 착수
> 원본: `conversations/2026-02-23-세션7.md`

### 결정 사항
1. 상위 에이전트의 정체성 전환: 오케스트레이터 → **대화형 연구 동료**. 서비스 경험 전반을 기억하고 연구 방향을 함께 논의하는 주체
2. 핵심전제 2번(상호 보완적 시너지)이 1번(연구 의도 내재화)을 돕는 구조: 의도를 내재화했기에 주도권을 제안할 수 있다
3. 오케스트레이션도 연구 동료가 담당 — 맥락을 가장 잘 아는 주체가 워크플로도 조율하는 것이 자연스럽다
4. 서비스를 처음부터 재설계. 레거시 호환 고려 안 함. 기존 문서는 재료
5. SPEC.md 완전 재작성 — 5개 새 UI/UX 개념 도입:
   - **대화 캔버스**: 대화가 메인 인터페이스, 구조화 데이터가 인라인으로 공존
   - **제안 카드**: 동료가 다음 행동 + 주도권 수준 + 근거를 제안
   - **연구 아티팩트**: 대화에서 생성되어 축적되는 구조화된 결과물
   - **경험 기억**: 연구 여정 전체를 기억, 세션 간에도 지속
   - **주도권 신호**: 현재 누가 주도하는지 시각적 표시
6. **동적 자율성**: 자율성 수준은 기능별 고정이 아니라, 동료가 맥락에 따라 조절해서 제안
7. 안전망 매핑: Phase별 → 아티팩트 자율성 수준별로 전환

### 근거
- 기존 설계는 검색 도구 패러다임(고정 Phase 순차 흐름)에 기반. 대원칙(대화형 연구 동료)과 괴리
- "AI가 주도권을 제안한다"는 개념은 기존 UI/UX에 없으므로 창의적 접근 필요
- Phase 구조 제거: 대화형 시스템에서 사용자는 언제든 이전/다음을 오갈 수 있어야 함
- 분석 구조 고정 제거: 연구 동료라면 맥락에 따라 다른 분석을 제안해야 함

### 미완료 (다음 세션)
- ~~architecture.md, state-management.md, design-state-alignment.md, observability.md, conventions.md 재작성~~ → 세션 8에서 완료

## 2026-02-23 | Light House 하위 문서 완전 재작성 + 기술 결정
> 원본: `conversations/2026-02-23-세션8.md`

### 결정 사항

#### 문서 재작성 (5개)
1. **architecture.md** 완전 재작성 — 도메인 결 3가지(이벤트 스트림+리소스+워크플로), LLM 상위 에이전트 아키텍처(function calling 오케스트레이션), 대화 프로토콜(5개 메시지 타입), 3계층 기억 시스템, 4개 데이터 모델, 3-Plane 코드 매핑
2. **state-management.md** 완전 재작성 — Conversation=SSOT, 서버/클라이언트 상태 분리, 4개 Zustand 스토어(conversation/artifact/agent/ui), 에이전트 실행 FSM(자율성 수준별 경로), 아티팩트 관계 유형(parent-child/reference)
3. **design-state-alignment.md** 완전 재작성 — 핵심 명제 5개, 원칙-상태 매핑 7개, 상세 흐름 예시 4개(대화→검색, 클러스터링 제안→승인, 경험 기억 활용, 주도권 전환), 실패 사례 5개, 코드 리뷰 체크리스트 7개
4. **observability.md** 부분 재작성 — 상위 에이전트 관측 계층 신설(대화 턴, 도구 호출, 자율성 판단, 제안 카드 수락률, 주도권 전환, 기억 활용), Phase 참조 전면 제거, 카테고리 5개로 재편
5. **conventions.md** 업데이트 — 서버사이드 코드 규칙(agent/tools/repository 구조), 대화 프로토콜 타입 규칙(판별 유니온, 아티팩트 참조 마커), 아티팩트 타입 정의 규칙 추가

#### 기술 결정 (열린 질문 5개 해소)
1. **상위 에이전트 LLM**: Gemini 3 Flash Preview — tool calling + 대용량 컨텍스트
2. **스트리밍 구현**: Vercel AI SDK (`ai` + `@ai-sdk/google`) — tool calling + SSE 통합, 보일러플레이트 최소화
3. **서버사이드 저장**: Supabase (Postgres + Auth + RLS) — 인증 내장, Row Level Security로 사용자별 데이터 격리, 무료 티어 500MB
4. **경험 기억 범위**: 세션 간 포함 — 세션 종료 시 LLM이 핵심 기억 추출, 새 세션 시 최근 N개 세션의 전체 기억을 시스템 프롬프트에 주입. 기억 선별(유사도 기반)은 프로토타입에서 스킵
5. **기존 코드 재활용**: 핵심 로직(프롬프트, Zod 스키마, 응답 파싱) 추출하여 tool 함수로 재사용. API route 껍데기는 버림 (function calling으로 대체)

### 근거
- 보일러플레이트 최소화가 기술 선택의 일관된 기준 — AI SDK(tool calling 루프 자동화), Supabase(인증+DB 통합), 핵심 로직 재사용(프롬프트 재검증 불필요)
- 경험 기억은 Light House의 차별점 — "동료는 연구 여정 전체를 기억한다"를 프로토타입에서 빼면 챗봇과 구분 불가
- Supabase 채택: 경험 기억이 사용자별이므로 인증이 필수. Supabase Auth + RLS가 이를 DB 레벨에서 해결
- 파일 기반 저장 기각: Vercel 서버리스는 읽기 전용 파일시스템, 영속 불가

## 2026-02-23 | 일정 관리 체계 도입
> 원본: `conversations/2026-02-23-세션9.md`

### 결정 사항
1. task-management-principle.md에 "일정 연동" 섹션 추가 — 외부 공유/배포/테스트 마일스톤에 날짜와 must-have를 명시
2. 별도 캘린더 도구는 도입하지 않는다 — 문서에 날짜를 적는 것으로 충분
3. 일정: 2/24 팀 공유 → 2/26, 3/2 후속 공유 → 3월 1주 비공개 알파 테스트

### 근거
- 설계 단계에서는 시간 축이 불필요했으나, 외부 공유 일정이 생기면서 우선순위가 "중요도순"에서 "시연 가능 여부순"으로 전환
- "불확실성이 클 때는 단순하게 시작" 원칙에 따라 최소한의 시간 축만 추가

## 2026-02-23 | 시연 검증 + 후속 개선 아젠다 수립
> 원본: `conversations/raw/2026-02-23-세션10.md`

### 결정 사항
1. 시연 6단계 흐름 정의 및 검증 완료 (대화→검색→분석→아티팩트→제안카드→경험기억)
2. 안정화 작업 확인: 버그 4건 수정 + 기억 주입 프롬프트 개선
3. 후속 개선 4건 아젠다 확정: 톤 전환, 온보딩, 페이퍼 리스트, 주기적 중간 정리

### 근거
- 2/24 팀 공유 must-have 기준으로 시연 가능 여부 판단
- 안정화 완료 확인 후 다음 단계로 전환

## 2026-02-23 | 온보딩 설계 — AI 동료가 직접 관계를 형성한다
> 원본: `conversations/raw/2026-02-23-세션10.md`

### 결정 사항
1. 별도 온보딩 화면/설문 없이 **첫 대화 자체가 온보딩**
2. 관계 형성 심리학 탐색 결과를 설계에 적용: 따뜻함 우선, 점진적 자기 노출, 공유 경험이 전환점
3. 연구 동료 이름 도입: **corca(코르카)**, 사용자 변경 가능
4. 첫 방문 판단: research_journeys 0건 → 첫 방문. 자동 대화 생성 + corca 선인사
5. 첫 탐색에서 corca가 각 단계를 간단히 설명. 두 번째 탐색부터는 설명 생략
6. 관계 형성 원칙을 ai-service-design-principles.md에 범용 원칙으로 역수입

### 근거
- AI가 동료 수준의 주체라면 온보딩도 동료가 직접 한다 — 별도 화면은 도구 패러다임
- Fiske(따뜻함/역량), Aron(점진적 자기 노출), Mayer(신뢰 3기둥), 신속 신뢰 이론이 설계 근거
- 이름이 있으면 도구→동료 인식 전환이 즉각적

## 2026-02-23 | 주기적 중간 정리 + 톤 전환 + 페이퍼 리스트
> 원본: `conversations/raw/2026-02-23-세션10.md`

### 결정 사항
1. 주기적 중간 정리: 도구 3회 이상 / 10턴 이상 / 주제 전환 시 corca가 propose로 매듭 제안. 간결 요약(3~5줄) 후 방향 연결
2. 대화 톤: ~다 체 → 존대말(~습니다/~해요 체). 동료 정체성은 유지
3. 페이퍼 리스트: 대화 귀속 유지, 우측 캔버스 패널로 별도 목록 뷰 추가. DB 스키마 변경 없이 artifacts 테이블 필터 조회

### 근거
- 중간 정리: 분석이 쌓이면 방향을 잃기 쉽다. propose 메커니즘 재활용으로 구현 비용 최소
- 톤 전환: 외부 사용자 대상 서비스에서 ~다 체는 부자연스럽다
- 페이퍼 리스트: 논문 목록의 대화 횡단 조회 필요. 새 테이블 없이 기존 구조 활용

## 2026-02-23 | 관계 형성 원칙 → 서비스 설계 방법론 역수입
> 원본: `conversations/raw/2026-02-23-세션10.md`

### 결정 사항
1. ai-service-design-principles.md에 "관계 형성" 섹션 추가
2. 핵심: "별도 온보딩을 두지 않는다. AI가 동료라면 관계 형성도 동료가 직접 한다"
3. 6개 원칙: 따뜻함 우선, AI 선자기노출, 첫 경험 결정적, 공유 경험이 전환점, 한계 인정=신뢰, 호혜성 재설계
4. 위치: 제어감 → 관계 형성 → 체크리스트 순서

### 근거
- Light House에서 실전 검증된 원칙을 범용화하는 역수입 패턴 (세션 7에서 확립)
- "AI는 동료 수준의 주체이다"(핵심 전제 2번)의 자연스러운 확장

## 2026-02-23 | Light House UI 패러다임 전환 — Living Notebook
> 원본: `conversations/2026-02-23-세션11.md`

### 결정 사항
1. 채팅 UI → **Living Notebook** 패러다임 전환. 채팅 버블 제거, PDF-like 문서 스트림으로 교체
2. 핵심 메타포: "AI에게 말을 건다" → "동료와 함께 문서를 작성한다"
3. **3단 분할 레이아웃 (C 타입)**: 노트북(메인) + Board(우상) + Graph(우하) 동시 표시
4. 좌측 사이드바 → **상단 내비게이션 바** + 세션 드롭다운. 수평 공간 200px 확보
5. Research Board: 세로 칸반 4단계 (Discovered → Reviewed → Important → Archived). 도구 실행 결과 자동 반영
6. Timeline + Knowledge Graph: 타임라인(연구 이벤트 시각화) + 네트워크(논문 관계 그래프) 서브뷰
7. 인용 엣지는 1차에서 제외, 클러스터/검색 관계만 우선 구현

### 근거
- 채팅 버블은 "도구에게 말한다" 멘탈 모델을 강화. 동료 정체성과 괴리
- 탭 전환보다 메인 화면 분할이 인지 비용이 낮다 — 동시 참조가 가능
- 세션 목록은 드롭다운으로 충분 — 사용자가 세션을 자주 전환하지 않음
- 8가지 UI 방향 탐색 결과, 단일 패턴보다 조합(노트북+칸반+그래프)이 차별성 생성

## 2026-02-24 | Board+Graph 제거 + 연구 시나리오 기반 고도화로 전환
> 원본: `conversations/2026-02-24-세션12.md`

### 결정 사항
1. Board(칸반)와 Graph(타임라인/네트워크)를 제거한다. 코드는 이미 삭제 완료.
2. 새 방향: 연구자가 실제로 논문을 탐색하는 시나리오를 기반으로 서비스를 고도화한다
3. 5가지 핵심 시나리오 식별: 새 분야 진입 / 제안서 준비 / 논문 맥락 파악 / 트렌드 파악 / 현행 유지
4. 모든 시나리오에 1차 대응, 시나리오 1(새 분야 진입)과 2(제안서 준비)를 심화 지원
5. Library UI는 시나리오 기반 고도화 완료 후 재논의

### 근거
- Board+Graph는 대화 속 데이터를 재배치한 것에 불과. 연구자 의사결정에 기여하지 못함
- 연구 동료가 시나리오를 깊이 이해하고 그에 맞게 대응하는 것이 진짜 UI/UX
- 시각적 컴포넌트보다 대화의 품질이 사용자 경험을 결정한다

## 2026-02-24 | AI 서비스 설계 원칙 — 사용자 행동 이해
> 원본: `conversations/2026-02-24-세션12.md`

### 결정 사항
1. ai-service-design-principles.md에 "사용자 행동의 깊은 이해" 섹션 추가
2. 핵심 명제: **AI 동료 서비스에서 진짜 UI/UX는 시각적 컴포넌트가 아니라 대화의 품질이다**
3. 4가지 원칙: 시나리오 수집 → 자율성 결정 → 전체 흐름 인지 → 점진적 커버
4. service-principles.md에 시나리오별 지원 테이블과 시나리오→설계 요구 매핑 추가

### 근거
- 도구는 기능만 제공하면 되지만, 동료는 상대의 작업 맥락을 알아야 의미 있는 제안을 할 수 있다
- Light House에서 연구자 시나리오 수집 → 서비스 설계 방향 구체화의 경험을 범용 원칙으로 추출
- Ellis 모델, Kuhlthau ISP, Bates Berry Picking 등 학술 근거 기반

## 2026-02-24 | 시스템 프롬프트 시나리오 인지 섹션 설계
> 원본: `conversations/2026-02-24-세션12.md`

### 결정 사항
1. corca 시스템 프롬프트에 시나리오 인지 섹션을 추가한다
2. 시나리오 식별: 사용자 발화에서 5가지 신호를 읽고, 불명확하면 자연스럽게 확인
3. 시나리오 1 심화: 키워드 제안 → 핵심 논문 식별 → 하위 문제 구조화 → snowballing → 점진적 자율성
4. 시나리오 2 심화: 대량 트리아지 → 용어 변이 감지 → 개념적 분류 → 갭 분석 → 시간 효율 흐름
5. 시나리오 3~5 기본: 각각 핵심 대응 전략 정의
6. 공통 행동: 용어 변이 인지, 중복 감지, 맥락 연결, 진행 상태 인지

### 근거
- 현재 프롬프트는 도구별 자율성만 정의. 시나리오 인지가 없어 모든 요청에 동일하게 대응
- 연구자 행동 리서치에서 시나리오별 탐색 전략과 고충이 다르다는 것이 확인됨
- 시나리오 인지가 있어야 "동료"로서 맥락에 맞는 제안 가능

## 2026-02-24 | 대화 플로우 시나리오 기반 개선 5건
> 원본: `conversations/2026-02-24-세션13.md`

### 결정 사항
1. `find_related_papers` 도구 추가 — Semantic Scholar citations/references API 활용, 시나리오 1,2,3의 snowballing 지원
2. 연쇄 규칙 시나리오별 분기 — 시나리오 2(제안서)에서만 search→analyze→evaluate 한 턴 연쇄 허용. 시나리오 1은 기본 규칙 유지
3. 메모리 주입 규칙 시나리오 연동 — 시나리오 5(현행 유지)는 적극적 연결, 시나리오 1(새 분야)는 기본 규칙
4. search_papers year 필터 추가 — 시나리오 5의 최근 논문 검색 지원
5. cluster_papers criteria 파라미터 추가 — 코르카가 "방법론별", "접근법별" 등 분류 기준 지정 가능

### 근거
- 시나리오를 프롬프트에 넣었지만, 도구와 규칙이 시나리오를 지원하지 않으면 실행 불가
- 시나리오별 탐색 전략이 다르므로 연쇄 규칙/메모리 규칙도 달라야 한다
- snowballing은 3개 시나리오에서 공통 필요

## 2026-02-24 | Library v2 설계 — 시나리오 기반 재설계
> 원본: `conversations/2026-02-24-세션13.md`

### 결정 사항
1. Library v1 드래프트(범용 CRUD UI) 기각. 시나리오와 무관한 카드뷰/테이블뷰/컬렉션은 Board+Graph와 같은 "데이터 재배치" 함정
2. Library의 존재 이유: **대화만으로 부족한 순간** — 공간적 조망, 일괄 비교, 축적 탐색 3가지
3. **인라인 모드** (우선): 사이드 패널로 Landscape View(클러스터 강화) + Triage View(검색 결과 테이블). 기존 아티팩트 렌더러에서 트리거
4. **탭 모드** (후순위): 세션 횡단 축적 탐색. 축적이 충분해진 후 재논의
5. v1의 컬렉션 시스템, organize_library 도구, 4개 API 엔드포인트는 모두 제거. 신규 DB 변경 최소화
6. panel-store (Zustand)로 패널 상태 관리. 한 번에 하나의 뷰만 표시

### 근거
- "진짜 UI/UX는 시각적 컴포넌트가 아니라 대화의 품질이다" (세션 12 결론)
- Library는 대화의 한계를 보완하는 역할이지, 독립된 관리 도구가 아니다
- 인라인 모드 우선: 기존 아티팩트 데이터 재활용, 신규 도구/DB 불필요, 범위 대폭 축소

## 2026-02-24 | 3컬럼 레이아웃 확정 + 패널 관리 시스템
> 원본: 세션 14

### 결정 사항
1. 세션 사이드바 제거, 3컬럼 고정 레이아웃: **노트북(3) | 논문 패널(4) | 연구 패널(3)**
2. 논문 패널에 최대 비율(4) — 트리아지가 가장 빈번한 활동이므로 최대 공간
3. 노트북이 좌측 — 시선 시작점, 논문 패널과 인접하여 "대화하며 트리아지" 최적화
4. 3개 패널 모두 독립 접기/펼치기 가능, 접힌 공간은 남은 패널이 비율 유지하며 분배
5. corca가 연구 활동 전환 시점에 패널 구성을 **제안**(propose 메커니즘 활용). 자동 전환 아님
6. 세션 13의 "한 번에 하나의 뷰만 표시" + "아티팩트 렌더러 트리거" 결정을 폐기

### 근거
- 노트북+논문이 가장 빈번한 조합(시나리오 1,2 모두). 인접 배치가 핵심
- 패널 열기/닫기는 인지 모드 전환(대화/조망/평가)에 대응
- 자동 전환이 아니라 제안이어야 제어감 유지 (mirror-mind 원칙 3)
- 연구 패널은 우측 끝이어도 무방 — 클러스터링 완료 시점에만 집중적 참조

## 2026-02-24 | 논문 패널 고도화 — 트리아지 테이블 + 맥락 보존
> 원본: 세션 14

### 결정 사항
1. 트리아지 테이블: 제목/저자/학회/년도/인용수/중요도 컬럼, 정렬/필터, 인라인 초록 프리뷰
2. 발견 맥락 표시: 각 논문이 어떤 검색/snowballing에서 왔는지 기록·표시
3. Snowballing 연결: 참조/인용 수 표시, 허브 논문 강조, 패널에서 직접 find_related_papers 호출
4. 클러스터 그룹 뷰: 클러스터별 그룹핑 대체 뷰, 트리아지 테이블과 동일 기능

### 근거
- 연구자의 핵심 행동은 트리아지(200→30→10→3). 판단 기준은 초록/저자/학회/인용수/년도
- "이 논문을 왜 찾았는지" 맥락 소실이 가장 큰 고충 (research-scenarios.md)
- snowballing 도구가 이미 있으므로 패널에서 표시만 추가하면 연결 완성

## 2026-02-24 | 기억 시스템 재설계 — 에피소드 기억 + 관계 형성
> 원본: 세션 14

### 결정 사항
1. 기존 research_journeys(4가지 요약 기억)를 **memory_episodes** 테이블로 대체
2. LLM이 대화를 의미 단위(에피소드)로 쪼개고, 각 에피소드에 구조화 분류를 부여:
   - activity_type (검색, 분석, 트리아지, 클러스터링, snowballing, 논의 등)
   - scenario (새 분야 진입, 제안서 준비 등)
   - emotion (불안, 집중, 좌절, 흥분, 놀람 등)
   - outcome (성공, 실패, 중립, 예상 밖)
   - relationship_type (함께 헤맴, 신뢰 구축, 의견 충돌, 돌파 등)
   - milestone_key (시드 경험 매칭 시)
3. 도구 결과(검색 42편 등)는 에피소드에 요약 + artifact ID 참조로 저장. 원시 데이터 복제 안 함
4. 벡터 검색 없이 구조화 쿼리만으로 시작. 분류가 충분히 풍부하면 쿼리로 커버 가능. 벡터는 필요 시 후행 도입
5. 경험 마일스톤은 별도 테이블이 아니라 memory_episodes의 milestone_key로 통합
6. 관계 단계(초기→형성→신뢰→깊은 협력)는 에피소드 집계로 산출
7. 메모리 시스템을 **독립 모듈로 모듈화** — lighthouse에 종속시키지 않고 범용 재사용 가능하게 설계

### 근거
- 기존 시스템은 대화 전체를 4문장으로 요약하여 정보 손실 극심
- LLM은 대화 세그멘테이션과 분류를 잘 수행 — 구조화 저장으로 정밀 조회 가능
- 2계층(에피소드+마일스톤) 분리 대신 단일 테이블이 단순하고 조회도 통합
- 논문 패널의 "발견 맥락 표시"와 직결 — artifact ID 참조로 연결

## 2026-02-24 | 관계 형성 고도화 → AI 서비스 설계 원칙 확장
> 원본: 세션 14

### 결정 사항
1. 관계 형성을 "온보딩 단계"가 아닌 **모든 상호작용에서 깊어지는 연속적 과정**으로 재정의
2. 경험의 3차원: 활동(무엇을 했는가) + 결과(성공/실패/예상 밖) + 관계(둘 사이에 어떤 일이)
3. 시드 경험 목록(정적) + 동적 경험 확장(3회 반복 패턴 감지 시 자동 등록)
4. 관계 깊이 4단계(초기→형성→신뢰→깊은 협력), 신뢰 단계 전환에는 실패 후 회복 같은 "어려운 경험"이 필수
5. ai-service-design-principles.md에 확장 반영 완료

### 근거
- 동료 관계는 지식/정보 교환만으로 만들어지지 않음. 함께 헤매고 실패하고 돌파하는 경험이 핵심
- Light House 경험 추적 + 기억 시스템 설계에서 범용 원칙으로 추출
- 경험이 기억 시스템과 직결되어야 실질적으로 행동 변화를 만들 수 있음

## 2026-02-24 | UI 패러다임 전환 — LLM 동적 문서 생성 + 2컬럼 레이아웃
> 원본: 세션 15

### 결정 사항
1. **컴포넌트 기반 → 문서 기반 패러다임 전환**: 고정 React 컴포넌트(TriageTable, ClusterView 등)로 데이터를 렌더링하는 방식을 폐기. LLM이 마크다운 문서를 동적으로 작성하고, 패널은 그 문서를 렌더링한다
2. **3컬럼 → 2컬럼 레이아웃**: 노트북 | 연구 문서 패널. 논문 패널과 연구 패널을 하나의 "연구 문서 패널"로 통합
3. **좌측 사이드바 부활**: 2컬럼으로 공간이 확보되므로 세션 사이드바를 다시 도입
4. **검색 결과를 우측 패널에 md 포맷으로 표시**: 노트북에 PaperCard를 나열하는 대신, 우측 패널에 LLM이 구성한 마크다운 문서로 표시
5. **인터랙티브 슬롯은 최소한으로 시작**: 마크다운 렌더링 기본, 필요에 따라 인터랙티브 요소 점진 추가
6. **기존 TriagePanel, LandscapePanel, 관련 컴포넌트 제거**
7. **새 도구 `update_research_panel` 도입**: LLM이 우측 패널의 문서를 작성/갱신하는 도구

### 근거
- 외부 서비스 UI 벤치마크에서 "결과물을 md 파일로 구성하여 패널에 표시"하는 패턴 발견
- 고정 컴포넌트는 시나리오별로 다른 구조를 표현할 수 없다. LLM이 문서를 작성하면 시나리오에 따라 구조 자체가 달라진다
- "AI는 데이터 공급자가 아니라 문서를 작성하는 동료" — 동료 패러다임의 자연스러운 확장
- 3컬럼은 시나리오별 패널 구성이 복잡했고, 2컬럼+문서 기반이 더 단순하면서 유연하다
- 세션 14의 3컬럼, 패널별 고정 컴포넌트 결정을 폐기

### 폐기된 결정
- 세션 14: 3컬럼 고정 레이아웃 (노트북3|논문4|연구3)
- 세션 14: 논문 패널 고도화 (TriageTable, ClusterGroupView 등 고정 컴포넌트)
- 세션 13: panel-store의 triage/landscape 분리 구조

## 2026-02-24 | 논문 리스트 구조화 + 검색 결과 자동 문서 생성
> 원본: 세션 15

### 결정 사항
1. **```papers 코드블록** 도입 — 연구 문서 내 논문 리스트를 JSON 구조로 작성, PaperListBlock 커스텀 렌더러가 링크·저자·reason 포함 리스트로 렌더링
2. **검색 결과 자동 패널 문서** — search_papers, find_related_papers 실행 시 사이드이펙트로 전체 결과를 `search_results` 타입 아티팩트로 자동 생성. corca의 분석 문서와 별도로 패널에 표시
3. **reason 필드가 핵심 차별점** — corca가 작성하는 분석 문서의 papers 블록에는 reason(선별 이유)을 포함. 자동 생성된 검색 결과에는 reason 없음

### 근거
- 벤치마크 UI에서 Relevance Reasoning이 가장 큰 수확이었음
- 검색 결과 전체(42편)와 corca의 선별(5편+이유)은 다른 관심사
- 자동 생성으로 검색 완료 즉시 패널에 결과가 표시되어 체감 속도 개선

## 2026-02-24 | 기억 시스템 — 연구 문서 패러다임 반영
> 원본: 세션 15

### 결정 사항
1. memory_episodes에서 연구 내용 요약(summary) 제거 — 연구 문서 아티팩트가 그 역할 대체
2. artifact_refs(도구 결과 복수 참조) → document_ref(연구 문서 단일 참조)로 변경
3. 에피소드는 관계·감정·결과만 담는다 — 연구 내용은 문서가, 관계 맥락은 에피소드가
4. 메모리 주입: 이전 세션의 연구 문서 목록 + 에피소드의 관계 컨텍스트를 분리 주입

### 근거
- 연구 문서가 이미 "무엇을 찾았고, 어떻게 구조화했고, 무엇이 빠져있는지"를 정리한 문서
- 이를 별도로 에피소드에 다시 요약하는 것은 중복
- 에피소드의 역할이 명확해짐: 관계 형성 추적에 집중

## 2026-02-24 | 1차 팀 공유 결과 + 핵심 과제 식별
> 원본: 세션 15

### 결과
- 2/24 17:00 팀 공유 진행. 서비스가 제대로 동작하지 않아 공감을 얻지 못함
- **핵심 실패 원인: 응답 속도**. 검색 + 결과 표시가 오래 걸려서 후속 대화가 다이나믹하게 진행되지 않음. 발표자가 말로 설명하는 방식으로 대체
- 동료 경험의 전제 조건인 "대화 흐름의 속도"가 충족되지 않으면, 기능이 아무리 좋아도 "느린 검색 도구"로 인식됨

### 다음 단계
- **2/26 후속 공유까지 응답 속도 개선이 최우선**
- 병목: LLM 2회(판단+문서생성) + 외부 API 1회가 순차 실행
- 기능 추가보다 "검색하고 대화가 이어지는 속도"를 극적으로 개선하는 것이 팀 공감의 유일한 방법

## 2026-02-24 | 에피소드 기반 기억 시스템 도입
> 원본: 세션 16

### 결정 사항
1. Light House 에피소드 메모리 시스템을 mirror-mind에 적응 (Supabase → JSON 파일 + git)
2. 에피소드 추출은 AI가 직접 수행 (대화를 읽고 구조화), API 기반 자동 스크립트는 보류
3. 세션 시작 시 query.py로 기억 조회, 대화 중 수시 조회, 종료 시 에피소드 추가
4. 에피소드 스키마: activity_type, project, topic, summary, emotion, outcome, relationship_type, milestone_key, scope

### 근거
- decisions.md 558줄을 세션 시작 시 훑는 것만으로는 과거 맥락 복원이 불가능
- 감정, 시행착오, 관계 변화 등 비결정적 맥락이 유실되고 있었음
- 프로그램적 필터 조회가 가능해야 기억이 축적될수록 활용 가능

---

## 2026-02-25 | 에이전트 관측 구조 리팩토링 + LLM 이원화 원칙

> 원본: 세션 17

### 결정 사항
1. 관측 전에 관측하기 좋은 구조를 만든다 — route.ts 모놀리식 핸들러를 orchestrator.ts로 추출, 5개 페이즈로 분리
2. 함수 경계 = 관측 경계 원칙 — TurnContext가 페이즈/스텝/도구 호출을 트리로 기록, 도구 래핑 패턴으로 개별 도구 파일 수정 없이 관측
3. LLM 호출 이원화 — 에이전트 수준(streamText, 멀티스텝, 도구 선택)과 도구 수준(단발 Gemini 호출, 구조화된 I/O)을 코드에서 명시 분리
4. 도구 수준 LLM 추상화 — executeJudgment 공통 실행 경로(Gemini 호출 + 파싱 + Zod 검증 + 에러 처리 + 관측), 프롬프트 구성과 후처리는 도구별 영역 유지
5. LLM 이원화 패턴을 technical-grain.md에 역수입 — 실전 패턴을 범용 원칙으로 승격

### 근거
- 관측 단위, 에러 처리, 확장 방향이 에이전트/도구 수준에서 모두 다르므로 분리가 필연적
- 6개 도구 파일이 동일한 Gemini 호출 뼈대를 재구현하고 있어 관측 포인트도 에러 처리도 제각각이었음
- 관측 가능한 구조가 선행해야 속도 분석과 개선이 가능 (2/26 팀 공유 대비)
